# load_confounds

[![Codacy Badge](https://api.codacy.com/project/badge/Grade/1da186ba5c44489b8af6d96a9c50d3c7)](https://app.codacy.com/gh/SIMEXP/fmriprep_load_confounds?utm_source=github.com&utm_medium=referral&utm_content=SIMEXP/fmriprep_load_confounds&utm_campaign=Badge_Grade_Dashboard) [![CircleCI](https://circleci.com/gh/SIMEXP/load_confounds.svg?style=svg)](https://circleci.com/gh/SIMEXP/load_confounds) [![codecov](https://codecov.io/gh/SIMEXP/load_confounds/branch/master/graph/badge.svg)](https://codecov.io/gh/SIMEXP/load_confounds)

This package is used to easily load a sensible subset of variables from [FMRIPREP](https://fmriprep.readthedocs.io/en/stable/) bold confounds in a python environment. The resulting pandas DataFrame can notably be used as `confounds`argument for [nilearn](https://nilearn.github.io/)'s masker functions. 

In order to use `load_confounds` it needs to be installed as a python environment (Python >=3.5) using:
```bash 
` pip install load_confounds
```
This module can then be imported: 
```python
from load_confounds import load_confounds
```
It is first possible to import confounds with a predefined preprocessing strategy:
```python 
confounds = load_confounds('path/to/file/sub-01_ses-001.tsv', strategy='minimal')
``` 

It is also possible to specify a subset of noise variables:
```python 
confounds = load_confounds('path/to/file/sub-01_ses-001.tsv', strategy=['high_pass', 'motion', 'global'])
``` 

Each type of noise variables can be further tweaked with dedicated arguments. The following example is using only the 6 basic moton parameters (translation, rotation), as well as both the averge and squared average of the white matter and cerebrospinal fluid masks:
```python 
confounds = load_confounds('path/to/file/sub-01_ses-001.tsv', strategy='minimal', motion='basic', 'wm_csf'='power2')
``` 
Currently the following noise categories are supported:
 * `motion` the motion parameters including 6 translation/rotation, and optionally derivatives, squares, and squared derivatives. Motion parameters can also be reduced through a PCA. Default: no PCA, and 24 motion moodel.
 * `high_pass` basis of discrete cosines covering slow time drift frequency band. 
 * `wm_csf` the average signal of white matter and cerebrospinal fluid masks, and optionally derivatives, squares, and squared derivatives. Default: simple average, without squares or derivatives.
 * `comp_cor` the results of a PCA applied on a mask based on either anatomy, temporal variance, or both. The number of components can be adjusted. Default: anat compcor with 6 components.
 * *globalÂ½  the global signal, and optionally derivatives, squares, and squared derivatives. Default: simple average without squares or derivatives.
 
 The predefined strategies currently implemented include: 
  * `minimal` this corresponds to `['motion', 'high_pass', 'wm_csf`]..
  * `minimal_glob` this corresponds to `['motion', 'high_pass', 'wm_csf', 'global']`.
  * `comp_cor` this corresponds to `['motion', 'high_pass', 'comp_cor`]`.
 Not that the choice of a strategy only defines the types of noise components included in the model, but not how this component is implemented. This is controlled through additional parameters. See the inline documentation of `load_confounds` for a detailed list of options.  
 
Finally, note that if a `.nii.gz` file is specified, `load_confounds` will automatically look for the companion `tsv`confound file generated by fMRIprep. A panda DataFrame can also be entered instead of a file name. It is also possible to specify a list of confound (or imaging) files, in which case `load_confounds` will return a list of pandas DataFrames. 
